<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="top.warmheart.workerunion.server.dao.FinalSettlementItemMapper">
	<resultMap id="BaseResultMap" type="top.warmheart.workerunion.server.model.FinalSettlementItem">
		<!-- WARNING - @mbg.generated This element is automatically generated by MyBatis Generator, do not modify. -->
		<id column="id" jdbcType="BIGINT" property="id" />
		<result column="company_id" jdbcType="BIGINT" property="companyId" />
		<result column="project_id" jdbcType="BIGINT" property="projectId" />
		<result column="subproject_name" jdbcType="VARCHAR" property="subprojectName" />
		<result column="submit_money" jdbcType="DECIMAL" property="submitMoney" />
		<result column="checked_money" jdbcType="DECIMAL" property="checkedMoney" />
		<result column="increased_money" jdbcType="DECIMAL" property="increasedMoney" />
		<result column="decreased_money" jdbcType="DECIMAL" property="decreasedMoney" />
		<result column="cst_create" jdbcType="TIMESTAMP" property="cstCreate" />
		<result column="cst_modified" jdbcType="TIMESTAMP" property="cstModified" />
		<result column="is_del" jdbcType="BIT" property="del" />
	</resultMap>
	<resultMap id="FinalSettlementItemDtoMap" type="top.warmheart.workerunion.server.dto.FinalSettlementItemDto">
		<id column="id" jdbcType="BIGINT" property="id" />
		<result column="company_id" jdbcType="BIGINT" property="companyId" />
		<result column="project_id" jdbcType="BIGINT" property="projectId" />
		<result column="subproject_name" jdbcType="VARCHAR" property="subprojectName" />
		<result column="submit_money" jdbcType="DECIMAL" property="submitMoney" />
		<result column="checked_money" jdbcType="DECIMAL" property="checkedMoney" />
		<result column="increased_money" jdbcType="DECIMAL" property="increasedMoney" />
		<result column="decreased_money" jdbcType="DECIMAL" property="decreasedMoney" />
		<result column="cst_create" jdbcType="TIMESTAMP" property="cstCreate" />
		<result column="cst_modified" jdbcType="TIMESTAMP" property="cstModified" />
		<result column="is_del" jdbcType="BIT" property="del" />
		<result column="has_attachment" jdbcType="BIT" property="hasAttachment" />
	</resultMap>
	<delete id="deleteByPrimaryKey" parameterType="java.math.BigInteger">
		<!-- WARNING - @mbg.generated This element is automatically generated by MyBatis Generator, do not modify. -->
		delete from final_settlement_item
		where id = #{id,jdbcType=BIGINT}
	</delete>
	<insert id="insert" parameterType="top.warmheart.workerunion.server.model.FinalSettlementItem">
		<selectKey keyProperty="id" order="AFTER" resultType="java.math.BigInteger">
			SELECT LAST_INSERT_ID()
		</selectKey>
		insert into final_settlement_item (company_id, project_id, subproject_name,
		submit_money, checked_money, increased_money,
		decreased_money, cst_create, cst_modified,
		is_del)
		values (#{companyId,jdbcType=BIGINT}, #{projectId,jdbcType=BIGINT}, #{subprojectName,jdbcType=VARCHAR},
		#{submitMoney,jdbcType=DECIMAL}, #{checkedMoney,jdbcType=DECIMAL}, #{increasedMoney,jdbcType=DECIMAL},
		#{decreasedMoney,jdbcType=DECIMAL}, now(), now(),
		false)
	</insert>
	<update id="updateByPrimaryKey" parameterType="top.warmheart.workerunion.server.model.FinalSettlementItem">
		<!-- WARNING - @mbg.generated This element is automatically generated by MyBatis Generator, do not modify. -->
		update final_settlement_item
		set company_id = #{companyId,jdbcType=BIGINT},
		project_id = #{projectId,jdbcType=BIGINT},
		subproject_name = #{subprojectName,jdbcType=VARCHAR},
		submit_money = #{submitMoney,jdbcType=DECIMAL},
		checked_money = #{checkedMoney,jdbcType=DECIMAL},
		increased_money = #{increasedMoney,jdbcType=DECIMAL},
		decreased_money = #{decreasedMoney,jdbcType=DECIMAL},
		cst_modified = now()
		where id = #{id,jdbcType=BIGINT}
	</update>
	<update id="deleteById" parameterType="top.warmheart.workerunion.server.model.FinalSettlementItem">
		update final_settlement_item
		set
		cst_modified = now(),
		is_del = true
		where id = #{id,jdbcType=BIGINT} and is_del=false
	</update>
	<select id="selectByPrimaryKey" parameterType="java.math.BigInteger" resultMap="BaseResultMap">
		<!-- WARNING - @mbg.generated This element is automatically generated by MyBatis Generator, do not modify. -->
		select id, company_id, project_id, subproject_name, submit_money, checked_money,
		increased_money, decreased_money, cst_create, cst_modified, is_del
		from final_settlement_item
		where id = #{id,jdbcType=BIGINT}
	</select>
	<select id="selectAll" resultMap="BaseResultMap">
		<!-- WARNING - @mbg.generated This element is automatically generated by MyBatis Generator, do not modify. -->
		select id, company_id, project_id, subproject_name, submit_money, checked_money,
		increased_money, decreased_money, cst_create, cst_modified, is_del
		from final_settlement_item
	</select>
	<select id="selectListByProjectId" resultMap="FinalSettlementItemDtoMap">
		select fsi.id, fsi.company_id, fsi.project_id, fsi.subproject_name, fsi.submit_money, fsi.checked_money,
		fsi.increased_money, fsi.decreased_money, fsi.cst_create, fsi.cst_modified, fsi.is_del,
		!isnull(fsia.final_settlement_item_id) as has_attachment
		from final_settlement_item fsi left join final_settlement_item_attachment fsia on fsia.final_settlement_item_id= fsi.id
		where fsi.project_id = #{projectId, jdbcType=BIGINT} and fsi.is_del=false
	</select>
</mapper>
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="top.warmheart.workerunion.server.dao.QualityCheckItemMapper">
	<resultMap id="BaseResultMap" type="top.warmheart.workerunion.server.model.QualityCheckItem">
		<!-- WARNING - @mbg.generated This element is automatically generated by MyBatis Generator, do not modify. -->
		<id column="id" jdbcType="BIGINT" property="id" />
		<result column="company_id" jdbcType="BIGINT" property="companyId" />
		<result column="project_id" jdbcType="BIGINT" property="projectId" />
		<result column="inspect_date" jdbcType="DATE" property="inspectDate" />
		<result column="inspect_record" jdbcType="VARCHAR" property="inspectRecord" />
		<result column="rectify_opinion" jdbcType="VARCHAR" property="rectifyOpinion" />
		<result column="project_feedback" jdbcType="VARCHAR" property="projectFeedback" />
		<result column="evaluate_date" jdbcType="DATE" property="evaluateDate" />
		<result column="evaluate" jdbcType="VARCHAR" property="evaluate" />
		<result column="rectify_status" jdbcType="VARCHAR" property="rectifyStatus" />
		<result column="staff_id" jdbcType="BIGINT" property="staffId" />
		<result column="staff_name" jdbcType="VARCHAR" property="staffName" />
		<result column="cst_create" jdbcType="TIMESTAMP" property="cstCreate" />
		<result column="cst_modified" jdbcType="TIMESTAMP" property="cstModified" />
		<result column="is_del" jdbcType="BIT" property="del" />
	</resultMap>
	<resultMap id="QualityCheckItemDtoMap" type="top.warmheart.workerunion.server.dto.QualityCheckItemDto">
		<id column="id" jdbcType="BIGINT" property="id" />
		<result column="company_id" jdbcType="BIGINT" property="companyId" />
		<result column="project_id" jdbcType="BIGINT" property="projectId" />
		<result column="project_num" jdbcType="VARCHAR" property="projectNum" />
		<result column="project_name" jdbcType="VARCHAR" property="projectName" />
		<result column="inspect_date" jdbcType="DATE" property="inspectDate" />
		<result column="inspect_record" jdbcType="VARCHAR" property="inspectRecord" />
		<result column="rectify_opinion" jdbcType="VARCHAR" property="rectifyOpinion" />
		<result column="project_feedback" jdbcType="VARCHAR" property="projectFeedback" />
		<result column="evaluate_date" jdbcType="DATE" property="evaluateDate" />
		<result column="evaluate" jdbcType="VARCHAR" property="evaluate" />
		<result column="rectify_status" jdbcType="VARCHAR" property="rectifyStatus" />
		<result column="staff_id" jdbcType="BIGINT" property="staffId" />
		<result column="staff_name" jdbcType="VARCHAR" property="staffName" />
		<result column="cst_create" jdbcType="TIMESTAMP" property="cstCreate" />
		<result column="cst_modified" jdbcType="TIMESTAMP" property="cstModified" />
		<result column="is_del" jdbcType="BIT" property="del" />
	</resultMap>
	<delete id="deleteByPrimaryKey" parameterType="java.math.BigInteger">
		<!-- WARNING - @mbg.generated This element is automatically generated by MyBatis Generator, do not modify. -->
		delete from quality_check_item
		where id = #{id,jdbcType=BIGINT}
	</delete>
	<insert id="insert" parameterType="top.warmheart.workerunion.server.model.QualityCheckItem">
		<selectKey keyProperty="id" order="AFTER" resultType="java.math.BigInteger">
			SELECT LAST_INSERT_ID()
		</selectKey>
		insert into quality_check_item (company_id, project_id, inspect_date,
		inspect_record, rectify_opinion,
		project_feedback,
		evaluate_date, evaluate, rectify_status,
		staff_id, staff_name, cst_create,
		cst_modified, is_del)
		values
		(#{companyId,jdbcType=BIGINT}, #{projectId,jdbcType=BIGINT}, #{inspectDate,jdbcType=DATE},
		#{inspectRecord,jdbcType=VARCHAR}, #{rectifyOpinion,jdbcType=VARCHAR}, #{projectFeedback,jdbcType=VARCHAR},
		#{evaluateDate,jdbcType=DATE}, #{evaluate,jdbcType=VARCHAR}, #{rectifyStatus,jdbcType=VARCHAR},
		#{staffId,jdbcType=BIGINT}, #{staffName,jdbcType=VARCHAR}, now(),
		now(), false)
	</insert>
	<update id="updateByPrimaryKey" parameterType="top.warmheart.workerunion.server.model.QualityCheckItem">
		update quality_check_item
		set company_id =
		#{companyId,jdbcType=BIGINT},
		project_id = #{projectId,jdbcType=BIGINT},
		inspect_date = #{inspectDate,jdbcType=DATE},
		inspect_record = #{inspectRecord,jdbcType=VARCHAR},
		rectify_opinion = #{rectifyOpinion,jdbcType=VARCHAR},
		project_feedback = #{projectFeedback,jdbcType=VARCHAR},
		evaluate_date = #{evaluateDate,jdbcType=DATE},
		evaluate =
		#{evaluate,jdbcType=VARCHAR},
		rectify_status = #{rectifyStatus,jdbcType=VARCHAR},
		staff_id = #{staffId,jdbcType=BIGINT},
		staff_name = #{staffName,jdbcType=VARCHAR},
		cst_modified = now()
		where id = #{id,jdbcType=BIGINT}
	</update>
	<select id="selectByPrimaryKey" parameterType="java.math.BigInteger" resultMap="BaseResultMap">
		<!-- WARNING - @mbg.generated This element is automatically generated by MyBatis Generator, do not modify. -->
		select id, company_id, project_id, inspect_date, inspect_record, rectify_opinion,
		project_feedback, evaluate_date,
		evaluate, rectify_status, staff_id, staff_name,
		cst_create, cst_modified, is_del
		from quality_check_item
		where id =
		#{id,jdbcType=BIGINT}
	</select>
	<select id="selectAll" resultMap="BaseResultMap">
		<!-- WARNING - @mbg.generated This element is automatically generated by MyBatis Generator, do not modify. -->
		select id, company_id, project_id, inspect_date, inspect_record, rectify_opinion,
		project_feedback, evaluate_date,
		evaluate, rectify_status, staff_id, staff_name,
		cst_create, cst_modified, is_del
		from quality_check_item
	</select>
	<select id="countByProjectId" resultType="java.lang.Integer">
		select count(distinct id)
		from quality_check_item where
		project_id=#{projectId,jdbcType=BIGINT}
	</select>
	<select id="pageByProjectId" resultMap="BaseResultMap">
		select a.id, a.company_id, a.project_id, a.inspect_date,
		a.inspect_record, a.rectify_opinion,
		a.project_feedback, a.evaluate_date, a.evaluate, a.rectify_status, a.staff_id,
		a.staff_name,
		a.cst_create, a.cst_modified, a.is_del
		from quality_check_item a,(select distinct id
		from quality_check_item
		where
		project_id=#{projectId,jdbcType=BIGINT} and is_del=false
		order
		by id
		desc limit
		#{page.frontIndex},#{page.size})temp
		where a.id=temp.id order by id desc
	</select>

	<update id="deleteById" parameterType="java.math.BigInteger">
		update quality_check_item
		set is_del=true,
		cst_modified = now()
		where id =
		#{id,jdbcType=BIGINT} and is_del=false
	</update>
	<select id="selectListByCompanyAndStatus" resultMap="QualityCheckItemDtoMap">
		select qci.id, qci.company_id, qci.project_id, qci.inspect_date, qci.inspect_record, qci.rectify_opinion,
		qci.project_feedback, qci.evaluate_date,
		qci.evaluate, qci.rectify_status, qci.staff_id, qci.staff_name,
		qci.cst_create, qci.cst_modified, qci.is_del, p.num as project_num, p.name as project_name
		from quality_check_item qci join project p on p.id=qci.project_id and p.is_del=false and qci.company_id=#{companyId,jdbcType=BIGINT} and qci.rectify_status=#{rectifyStatus,jdbcType=VARCHAR} and qci.is_del=false
	</select>
</mapper>